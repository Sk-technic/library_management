<%- include('layout') %>

<div class="relative max-w-3xl mx-auto mt-10 p-6 bg-white shadow-md rounded-lg">
    <h2 class="text-2xl font-bold mb-4 text-center">
        <i class="fas fa-book text-purple-600"></i> Allot a Book
    </h2>
    <a href="/dashboard" class="absolute top-2 right-2 border text-sm hover:text-white hover:bg-zinc-700 border-zinc-700 px-2 duration-300 rounded-lg">
        <i class="fa-solid fa-xmark"></i>                </a>     
    <form action="/books-borrow" method="POST" class="space-y-4">
        <!-- Select User -->
        <%= console.log("Filtered student users: ", users.filter(user => user.role === 'student')) %>
        <div>
            <label for="user_id" class="block text-gray-700 font-semibold">Select User</label>
            <select name="user_id" id="user_id" required class="w-full px-4 py-2 border rounded-lg focus:ring focus:ring-purple-300">
                <option value="" disabled selected class="text-gray-400 ">Choose a user</option>
                <% users.filter(user => user.role === 'student').forEach(user => { %>
                    <option value="<%= user.id %>">name: <%= user.name %> , email: <%= user.email %></option>
                <% }) %>
            </select>
        </div>
        

        <!-- Select Book -->
        <div>
            <label for="book_id" class="block text-gray-700 font-semibold">Select Book</label>
            <select name="book_id" id="book_id" required class="w-full px-4 py-2 border rounded-lg focus:ring focus:ring-purple-300">
                <option value="" disabled selected class="text-gray-400">Choose a book</option>
                <% books.forEach(book => { %>
                    <option value="<%= book.id %>">
                        <%= book.title %> by <%= book.author %> (ISBN: <%= book.isbn %>) - Available: <%= book.copies_available %>
                    </option>
                <% }) %>
            </select>
        </div>

        <!-- Borrow Date -->
        <div>
            <label for="borrow_date" class="block text-gray-700 font-semibold">Borrow Date</label>
            <input type="date" name="borrow_date" id="borrow_date" required class="w-full px-4 py-2 border rounded-lg focus:ring focus:ring-purple-300">
        </div>

        <!-- Return Date -->
        <div>
            <label for="return_date" class="block text-gray-700 font-semibold">Expected Return Date</label>
            <input type="date" name="return_date" id="return_date" class="w-full px-4 py-2 border rounded-lg focus:ring focus:ring-purple-300">
        </div>

        <!-- Status -->
        <div class="pointer-events-none">
            <label for="status" class="block text-gray-700 font-semibold">Status</label>
            <input type="text" value="borrowed" name="status" id="status" required class="w-full  px-4 py-2 border rounded-lg focus:ring focus:ring-purple-300">
             
        </div>

        <!-- Submit Button -->
        <button type="submit" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg transition duration-300">
            Allot Book
        </button>
    </form>
</div>
